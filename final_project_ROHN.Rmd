---
title: "BMIN503/EPID600 Final Project"
author: "Killian Rohn"
output: 
  html_document:
    toc: false 
    depth: 3 
    theme: paper 
    highlight: tango
---
```{r set-options, echo=FALSE, cache=FALSE}
options(width = 400)
```  
***
Use this template to complete your project throughout the course. Your Final Project presentation will be based on the contents of this document. Replace the title/name above and text below with your own, but keep the headers.

### Overview
Give a brief a description of your project and its goal(s), what data you are using to complete it, and what three faculty/staff in different fields you have spoken to about your project with a brief summary of what you learned from each person. Include a link to your final project GitHub repository.
```{r}
#I want to look at if/how marital status impacts survival across different genders and cancer  
#sites. I know in general epi literature, there is a tendency to see that marriage typically  
#is a stronger predictor of survival in men than in women depending on the disease.I plan to 
#further stratify by race.
```

### Introduction 
Describe the problem addressed, its significance, and some background to motivate the problem.

Explain why your problem is interdisciplinary, what fields can contribute to its understanding, and incorporate background related to what you learned from meeting with faculty/staff.
```{r}
#It has been found across social epidemiological studies that marital status can be a predictor 
#of survival outcomes for various diseases. Sometimes it is found that there is a  stronger 
#association between being married and longer survival for men than for women. I  intend to 
#investigate whether or not this pattern holds true for those diagnosed with various forms of 
#cancer in the US and Puerto Rico, utilizing the SEER dataset. I would also like to further 
#explore the effects of race on these potential associations. Epidemiology itself is an 
#interdisciplinary field, and this project will also utilize the fields of social epidemiology, 
#oncology, and biostatistics.

#I am using the SEER database below (over 8 million observations so far, so I can't upload it):

#Surveillance, Epidemiology, and End Results (SEER) Program (www.seer.cancer.gov) SEER*Stat 
#Database: Incidence - SEER 18 Regs Research Data + Hurricane Katrina Impacted Louisiana Cases, 
#Nov 2018 Sub (1975-2016 varying) - Linked To County Attributes - Total U.S., 1969-2017 
#Counties,National Cancer Institute, DCCPS, Surveillance Research Program, released April 2019, 
#based on the November 2018 submission.
```

### Methods
Describe the data used and general methodological approach. Subsequently, incorporate full R code necessary to retrieve and clean data, and perform analysis. Be sure to include a description of code so that others (including your future self) can understand what you are doing and why. 
```{r, warning=FALSE, message=FALSE}
library(tidyverse)
#load raw dataset
seer <- read.csv("C:/Users/kmroh/Desktop/BMIN503/dataset1.csv", header = T)
#view column names and rename variables of interest
colnames(seer)
seer <- seer %>%
  rename(patid = Patient.ID, 
         sex = Sex, 
         year.dx = Year.of.diagnosis,
         mstatus = Marital.status.at.diagnosis,
         race = Race.recode..White..Black..Other.,
         surv.months = Survival.months,
         cod.site = COD.to.site.recode,
         cod = SEER.cause.specific.death.classification,
         vital.status = Vital.status.recode..study.cutoff.used.,
         yob = Year.of.birth,
         prim.site = Primary.Site...labeled) 
seer$surv.months <- as.integer(seer$surv.months)
#see possible marital statuses
table(seer$mstatus)
#remove entries which are not married, partnered, or single at time of diagnosis
seer <- seer %>%
  filter(mstatus == "Married (including common law)" |
         mstatus == "Unmarried or Domestic Partner" |
         mstatus == "Single (never married)")
#recode to those who are partnered or not at the time of diagnosis
seer$part <- ifelse(seer$mstatus != "Single (never married)",
                    1,
                    0)
seer$part <- factor(seer$part, labels = c("Single","Partnered"))
#recode race variable
table(seer$race)
seer$race <- ifelse(seer$race == "Other (American Indian/AK Native, Asian/Pacific Islander)",
                    "Other", ifelse(seer$race == "White",
                                    "White", ifelse(seer$race == "Black",
                                                    "Black", ifelse(seer$race == "Unknown",
                                                                    "Unknown", 0))))
#remove those of unknown race 
seer <- seer %>%
  filter(race != "Unknown")
#remove those whose cause of death is unknown, or whose tumor is not the first
table(seer$cod)
seer <- seer %>%
  filter(cod == "Alive or dead of other cause Dead" |
         cod == "Dead (attributable to this cancer dx)")
#remove observations with unknown primary site and those that were alive at the study close
seer <- seer %>%
  filter(prim.site != "C80.9-Unknown primary site" |
           cod != "Alive")

#create group average of survival month by part variable
seer <- seer %>%
  group_by(part) %>%
  mutate(avg.pstatus = mean(surv.months, na.rm = T))

#create group average of survival month by sex
seer <- seer %>%
  ungroup() %>%
  group_by(sex) %>%
  mutate(avg.sex = mean(surv.months, na.rm = T))

#create group average of survival month by mar and sex variables
seer <- seer %>%
  ungroup %>%
  group_by(part,sex) %>%
  mutate(avg.part.sex = mean(surv.months, na.rm = T))

#recode primary site variable to body category
seer$c.code <- str_extract(seer$prim.site, "C[0-9][0-9]")
seer$c.code <- as.numeric(str_extract(seer$c.code, "[0-9][0-9]"))
seer$group <- ifelse(seer$c.code <= 14, "Lip, Oral Cavity and Pharynx",
 ifelse(seer$c.code <= 26,  "Digestive Organs",
 ifelse(seer$c.code <= 30,  NA,
 ifelse(seer$c.code <= 39,  "Respiratory and Intrathoracic Organs",
 ifelse(seer$c.code <= 41,  "Bone and Articular Cartilage",
 ifelse(seer$c.code == 42,  NA,
 ifelse(seer$c.code <= 44,  "Skin",
 ifelse(seer$c.code <= 49,  "Mesothelial and Soft Tissue",
 ifelse(seer$c.code == 50,  "Breast",
 ifelse(seer$c.code <= 58,  "Genital Organs",
 ifelse(seer$c.code == 59,  NA,
 ifelse(seer$c.code <= 63,  "Genital Organs",
 ifelse(seer$c.code <= 68,  "Urinary Tract",
 ifelse(seer$c.code <= 72,  "Eye, Brain or Central Nervous System",
 ifelse(seer$c.code <= 75,  "Thyroid & Endocrine Glands",
 ifelse(seer$c.code <= 80,  "Ill-Defined Sites",
 ifelse(seer$c.code <= 96,  "Lymphoid, Hematopoietic and Related Tissue", NA)))))))))))))))))
seer <- seer %>%
  ungroup %>%
  group_by(part,sex,race) %>%
  mutate(avg.race = mean(surv.months, na.rm = T)) %>%
  ungroup %>%
  group_by(part,sex,group) %>%
  mutate(avg.grp = mean(surv.months, na.rm = T)) %>%
  na.omit()

#create groups for pairwise ttests and anovas (there was probably a more elegant way to do this but this worked)
seer$psgroup[seer$sex == "Female" & seer$part == "Partnered"] <- 1
seer$psgroup[seer$sex == "Female" & seer$part == "Single"] <- 2
seer$psgroup[seer$sex == "Male" & seer$part == "Partnered"] <- 3
seer$psgroup[seer$sex == "Male" & seer$part == "Single"] <- 4
table(seer$psgroup)

seer$psrgroup[seer$sex == "Female" & seer$part == "Single" & seer$race == "White"] <- 1
seer$psrgroup[seer$sex == "Female" & seer$part == "Single" & seer$race == "Black"] <- 2
seer$psrgroup[seer$sex == "Female" & seer$part == "Single" & seer$race == "Other"] <- 3
seer$psrgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$race == "White"] <- 4
seer$psrgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$race == "Black"] <- 5
seer$psrgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$race == "Other"] <- 6
seer$psrgroup[seer$sex == "Male" & seer$part == "Single" & seer$race == "White"] <- 7
seer$psrgroup[seer$sex == "Male" & seer$part == "Single" & seer$race == "Black"] <- 8
seer$psrgroup[seer$sex == "Male" & seer$part == "Single" & seer$race == "Other"] <- 9
seer$psrgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$race == "White"] <- 10
seer$psrgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$race == "Black"] <- 11
seer$psrgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$race == "Other"] <- 12
table(seer$psrgroup)

seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Bone and Articular Cartilage"] <- 1
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Breast"] <- 2
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Digestive Organs"] <- 3
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Eye, Brain or Central Nervous System"] <- 4
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Genital Organs"] <- 5
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Ill-Defined Sites"] <- 6
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Lip, Oral Cavity and Pharynx"] <- 7
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Mesothelial and Soft Tissue"] <- 8
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Respiratory and Intrathoracic Organs"] <- 9
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Skin"] <- 10
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Thyroid & Endocrine Glands"] <- 11
seer$psbgroup[seer$sex == "Female" & seer$part == "Single" & seer$group == "Urinary Tract"] <- 12
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Bone and Articular Cartilage"] <- 13
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Breast"] <- 14
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Digestive Organs"] <- 15
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Eye, Brain or Central Nervous System"] <- 16
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Genital Organs"] <- 17
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Ill-Defined Sites"] <- 18
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Lip, Oral Cavity and Pharynx"] <- 19
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Mesothelial and Soft Tissue"] <- 20
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Respiratory and Intrathoracic Organs"] <- 21
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Skin"] <- 22
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Thyroid & Endocrine Glands"] <- 23
seer$psbgroup[seer$sex == "Male" & seer$part == "Single" & seer$group == "Urinary Tract"] <- 24
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Bone and Articular Cartilage"] <- 25
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Breast"] <- 26
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Digestive Organs"] <- 27
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Eye, Brain or Central Nervous System"] <- 28
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Genital Organs"] <- 29
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Ill-Defined Sites"] <- 30
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Lip, Oral Cavity and Pharynx"] <- 31
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Mesothelial and Soft Tissue"] <- 32
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Respiratory and Intrathoracic Organs"] <- 33
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Skin"] <- 34
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Thyroid & Endocrine Glands"] <- 35
seer$psbgroup[seer$sex == "Female" & seer$part == "Partnered" & seer$group == "Urinary Tract"] <- 36
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Bone and Articular Cartilage"] <- 37
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Breast"] <- 38
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Digestive Organs"] <- 39
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Eye, Brain or Central Nervous System"] <- 40
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Genital Organs"] <- 41
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Ill-Defined Sites"] <- 42
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Lip, Oral Cavity and Pharynx"] <- 43
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Mesothelial and Soft Tissue"] <- 44
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Respiratory and Intrathoracic Organs"] <- 45
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Skin"] <- 46
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Thyroid & Endocrine Glands"] <- 47
seer$psbgroup[seer$sex == "Male" & seer$part == "Partnered" & seer$group == "Urinary Tract"] <- 48
table(seer$psbgroup)

```

### Results
Describe your results and include relevant tables, plots, and code/comments used to obtain them. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.
```{r, warning=FALSE, message=FALSE}
#plot survival months by recoded marital status
library(rstatix)
library(ggpubr)

ggplot(seer, aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black")) +
  labs(title = "Survival Months by Marital Status at Diagnosis \nAll Sexes", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.pstatus,2), y = avg.pstatus))
#t-test for significance
t.test(seer$surv.months~seer$part)

#plot survival months by sex
ggplot(seer, aes(x=as.factor(sex), y=surv.months)) +
  geom_boxplot(aes(middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black")) +
  labs(title = "Survival Months by Sex", 
       x = "Sex", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.sex,2), y = avg.sex))
#t-test for significance
t.test(seer$surv.months~seer$sex)

#plot survival months by part and sex
ggplot(seer, aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.part.sex,2), y = avg.part.sex)) +
  facet_wrap(~sex)
#pairwise t-test and anova based on partner status and sex
pairwise.t.test(seer$surv.months, seer$psgroup, p.adjust.method = "bonferroni")
summary(aov(surv.months ~ psgroup, data = seer))


#plot survival months by part, sex, and race
ggplot(seer, aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis, \nSex, and Race", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  facet_grid(~ race + sex) +
  geom_text(aes(label = round(avg.race,2), y = avg.race))
#pairwise t-test and anova based on partner status, sex and race
pairwise.t.test(seer$surv.months, seer$psrgroup, p.adjust.method = "bonferroni")
summary(aov(surv.months ~ psrgroup, data = seer))

#plot survival months by part, sex and group
ggplot(subset(seer, group %in% c("Lip, Oral Cavity and Pharynx")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Lip, Oral Cavity and Pharynx", 
       x = "Relationship status", 
       y = "Survival Months") + 
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Digestive Organs")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Digestive Organs", 
       x = "Relationship status", 
       y = "Survival Months")  +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Respiratory and Intrathoracic Organs")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Respiratory and Intrathoracic Organs", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Bone and Articular Cartilage")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Bone and Articular Cartilage", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Skin")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Skin", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Mesothelial and Soft Tissue")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Mesothelial and Soft Tissue", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Breast")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Breast", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Genital Organs")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Genital Organs", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Urinary Tract")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Urinary Tract", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Eye, Brain or Central Nervous System")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Eye, Brain or Central Nervous System", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Thyroid & Endocrine Glands")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Thyroid & Endocrine Glands", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

ggplot(subset(seer, group %in% c("Ill-Defined Sites")), aes(x=as.factor(part), y=surv.months)) +
  geom_boxplot(aes(color = sex, middle = mean(surv.months))) +
  theme(plot.title = element_text(hjust = 0.5),
        panel.border = element_blank(), 
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), 
        axis.line = element_line(colour = "black"),
        legend.position = "none") +
  labs(title = "Survival Months by Marital Status at Diagnosis \nand Sex \nGroup: Ill-Defined Sites", 
       x = "Relationship status", 
       y = "Survival Months") +
  stat_summary(fun.y=mean, colour="yellow") +
  geom_text(aes(label = round(avg.grp,2), y = avg.grp)) +
  facet_wrap(~sex)

```

